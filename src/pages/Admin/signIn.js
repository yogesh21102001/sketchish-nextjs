import "./style.css";

import { Form, Formik } from "formik";
import { LabledInputBox } from "../../components/FormControles/index";
import { Button } from "../../components/Buttons/Button";
import useAuth from "../../hooks/common/useAuth";
import * as Yup from "yup";
import { useEffect, useState } from "react";
import { useNavigate } from "react-router-dom";
import { notifyError } from "../../utils/notify";
import { isAuthenticated } from "../../utils/helpers";

export function SignIn() {
  const navigate = useNavigate();
  const [isShakeAnim, setShakeAnim] = useState(false);
  const { setLogin } = useAuth();

  useEffect(() => {
    if (isAuthenticated()) {
      const auth = isAuthenticated();
      if (auth?.role === "admin") {
        navigate("/admin/icons");
      }
    }
  });

  return (
    <div className="admin-signIn">
      <svg
        className="os"
        width="184"
        height="41"
        viewBox="0 0 184 41"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_7299_71079)">
          <path
            d="M55.2575 29.1478C53.5775 29.1478 52.1055 28.7798 50.8415 28.0438C49.5935 27.3078 48.6095 26.2918 47.8895 24.9958C47.1855 23.6838 46.8335 22.1718 46.8335 20.4598C46.8335 18.7478 47.1855 17.2438 47.8895 15.9478C48.6095 14.6358 49.5935 13.6118 50.8415 12.8758C52.1055 12.1398 53.5775 11.7718 55.2575 11.7718C56.9215 11.7718 58.3855 12.1398 59.6495 12.8758C60.9135 13.6118 61.8975 14.6358 62.6015 15.9478C63.3055 17.2438 63.6575 18.7478 63.6575 20.4598C63.6575 22.1718 63.3055 23.6838 62.6015 24.9958C61.8975 26.2918 60.9135 27.3078 59.6495 28.0438C58.3855 28.7798 56.9215 29.1478 55.2575 29.1478ZM55.2575 26.3878C56.8575 26.3878 58.1295 25.8598 59.0735 24.8038C60.0335 23.7478 60.5135 22.2998 60.5135 20.4598C60.5135 18.6198 60.0335 17.1718 59.0735 16.1158C58.1295 15.0598 56.8575 14.5318 55.2575 14.5318C53.6575 14.5318 52.3775 15.0598 51.4175 16.1158C50.4575 17.1718 49.9775 18.6198 49.9775 20.4598C49.9775 22.2998 50.4575 23.7478 51.4175 24.8038C52.3775 25.8598 53.6575 26.3878 55.2575 26.3878Z"
            fill="#1E3050"
          />
          <path
            d="M66.2979 34.1398V16.9558H69.0339L69.3699 18.6598C69.7539 18.1318 70.2579 17.6678 70.8819 17.2678C71.5219 16.8678 72.3459 16.6678 73.3539 16.6678C74.4739 16.6678 75.4739 16.9398 76.3539 17.4838C77.2339 18.0278 77.9299 18.7718 78.4419 19.7158C78.9539 20.6598 79.2099 21.7318 79.2099 22.9318C79.2099 24.1318 78.9539 25.2038 78.4419 26.1478C77.9299 27.0758 77.2339 27.8118 76.3539 28.3558C75.4739 28.8838 74.4739 29.1478 73.3539 29.1478C72.4579 29.1478 71.6739 28.9798 71.0019 28.6438C70.3299 28.3078 69.7859 27.8358 69.3699 27.2278V34.1398H66.2979ZM72.7059 26.4598C73.6819 26.4598 74.4899 26.1318 75.1299 25.4758C75.7699 24.8198 76.0899 23.9718 76.0899 22.9318C76.0899 21.8918 75.7699 21.0358 75.1299 20.3638C74.4899 19.6918 73.6819 19.3558 72.7059 19.3558C71.7139 19.3558 70.8979 19.6918 70.2579 20.3638C69.6339 21.0198 69.3219 21.8678 69.3219 22.9078C69.3219 23.9478 69.6339 24.8038 70.2579 25.4758C70.8979 26.1318 71.7139 26.4598 72.7059 26.4598Z"
            fill="#1E3050"
          />
          <path
            d="M87.7381 29.1478C86.5381 29.1478 85.4741 28.8918 84.5461 28.3798C83.6181 27.8678 82.8901 27.1478 82.3621 26.2198C81.8341 25.2918 81.5701 24.2198 81.5701 23.0038C81.5701 21.7718 81.8261 20.6758 82.3381 19.7158C82.8661 18.7558 83.5861 18.0118 84.4981 17.4838C85.4261 16.9398 86.5141 16.6678 87.7621 16.6678C88.9301 16.6678 89.9621 16.9238 90.8581 17.4358C91.7541 17.9478 92.4501 18.6518 92.9461 19.5478C93.4581 20.4278 93.7141 21.4118 93.7141 22.4998C93.7141 22.6758 93.7061 22.8598 93.6901 23.0518C93.6901 23.2438 93.6821 23.4438 93.6661 23.6518H84.6181C84.6821 24.5798 85.0021 25.3078 85.5781 25.8358C86.1701 26.3638 86.8821 26.6278 87.7141 26.6278C88.3381 26.6278 88.8581 26.4918 89.2741 26.2198C89.7061 25.9318 90.0261 25.5638 90.2341 25.1158H93.3541C93.1301 25.8678 92.7541 26.5558 92.2261 27.1798C91.7141 27.7878 91.0741 28.2678 90.3061 28.6198C89.5541 28.9718 88.6981 29.1478 87.7381 29.1478ZM87.7621 19.1638C87.0101 19.1638 86.3461 19.3798 85.7701 19.8118C85.1941 20.2278 84.8261 20.8678 84.6661 21.7318H90.5941C90.5461 20.9478 90.2581 20.3238 89.7301 19.8598C89.2021 19.3958 88.5461 19.1638 87.7621 19.1638Z"
            fill="#1E3050"
          />
          <path
            d="M96.2979 28.8598V16.9558H99.0099L99.2499 18.9718C99.6179 18.2678 100.146 17.7078 100.834 17.2918C101.538 16.8758 102.362 16.6678 103.306 16.6678C104.778 16.6678 105.922 17.1318 106.738 18.0598C107.554 18.9878 107.962 20.3478 107.962 22.1398V28.8598H104.89V22.4278C104.89 21.4038 104.682 20.6198 104.266 20.0758C103.85 19.5318 103.202 19.2598 102.322 19.2598C101.458 19.2598 100.746 19.5638 100.186 20.1718C99.6419 20.7798 99.3699 21.6278 99.3699 22.7158V28.8598H96.2979Z"
            fill="#1E3050"
          />
          <path
            d="M116.707 29.1478C115.475 29.1478 114.387 28.9398 113.443 28.5238C112.499 28.0918 111.755 27.4838 111.211 26.6998C110.667 25.8998 110.387 24.9318 110.371 23.7958H113.611C113.643 24.5798 113.923 25.2438 114.451 25.7878C114.995 26.3158 115.739 26.5798 116.683 26.5798C117.499 26.5798 118.147 26.3878 118.627 26.0038C119.107 25.6038 119.347 25.0758 119.347 24.4198C119.347 23.7318 119.131 23.1958 118.699 22.8118C118.283 22.4278 117.723 22.1158 117.019 21.8758C116.315 21.6358 115.563 21.3798 114.763 21.1078C113.467 20.6598 112.475 20.0838 111.787 19.3798C111.115 18.6758 110.779 17.7398 110.779 16.5718C110.763 15.5798 110.995 14.7318 111.475 14.0278C111.971 13.3078 112.643 12.7558 113.491 12.3718C114.339 11.9718 115.315 11.7718 116.419 11.7718C117.539 11.7718 118.523 11.9718 119.371 12.3718C120.235 12.7718 120.907 13.3318 121.387 14.0518C121.883 14.7718 122.147 15.6278 122.179 16.6198H118.891C118.875 16.0278 118.643 15.5078 118.195 15.0598C117.763 14.5958 117.155 14.3638 116.371 14.3638C115.699 14.3478 115.131 14.5158 114.667 14.8678C114.219 15.2038 113.995 15.6998 113.995 16.3558C113.995 16.9158 114.171 17.3638 114.523 17.6998C114.875 18.0198 115.355 18.2918 115.963 18.5158C116.571 18.7398 117.267 18.9798 118.051 19.2358C118.883 19.5238 119.643 19.8598 120.331 20.2438C121.019 20.6278 121.571 21.1398 121.987 21.7798C122.403 22.4038 122.611 23.2118 122.611 24.2038C122.611 25.0838 122.387 25.8998 121.939 26.6518C121.491 27.4038 120.827 28.0118 119.947 28.4758C119.067 28.9238 117.987 29.1478 116.707 29.1478Z"
            fill="#1E3050"
          />
          <path
            d="M130.524 28.8598C129.276 28.8598 128.276 28.5558 127.524 27.9478C126.772 27.3398 126.396 26.2598 126.396 24.7078V19.5238H124.356V16.9558H126.396L126.756 13.7638H129.468V16.9558H132.684V19.5238H129.468V24.7318C129.468 25.3078 129.588 25.7078 129.828 25.9318C130.084 26.1398 130.516 26.2438 131.124 26.2438H132.612V28.8598H130.524Z"
            fill="#1E3050"
          />
          <path
            d="M135.321 28.8598V16.9558H138.057L138.345 19.1878C138.777 18.4198 139.361 17.8118 140.097 17.3638C140.849 16.8998 141.729 16.6678 142.737 16.6678V19.9078H141.873C141.201 19.9078 140.601 20.0118 140.073 20.2198C139.545 20.4278 139.129 20.7878 138.825 21.2998C138.537 21.8118 138.393 22.5238 138.393 23.4358V28.8598H135.321Z"
            fill="#1E3050"
          />
          <path
            d="M150.338 29.1478C149.186 29.1478 148.146 28.8838 147.218 28.3558C146.306 27.8278 145.578 27.0998 145.034 26.1718C144.506 25.2278 144.242 24.1398 144.242 22.9078C144.242 21.6758 144.514 20.5958 145.058 19.6678C145.602 18.7238 146.33 17.9878 147.242 17.4598C148.17 16.9318 149.21 16.6678 150.362 16.6678C151.498 16.6678 152.522 16.9318 153.434 17.4598C154.362 17.9878 155.09 18.7238 155.618 19.6678C156.162 20.5958 156.434 21.6758 156.434 22.9078C156.434 24.1398 156.162 25.2278 155.618 26.1718C155.09 27.0998 154.362 27.8278 153.434 28.3558C152.506 28.8838 151.474 29.1478 150.338 29.1478ZM150.338 26.4838C151.138 26.4838 151.834 26.1878 152.426 25.5958C153.018 24.9878 153.314 24.0918 153.314 22.9078C153.314 21.7238 153.018 20.8358 152.426 20.2438C151.834 19.6358 151.146 19.3318 150.362 19.3318C149.546 19.3318 148.842 19.6358 148.25 20.2438C147.674 20.8358 147.386 21.7238 147.386 22.9078C147.386 24.0918 147.674 24.9878 148.25 25.5958C148.842 26.1878 149.538 26.4838 150.338 26.4838Z"
            fill="#1E3050"
          />
          <path
            d="M159.181 28.8598V11.5798H162.253V21.7798L166.477 16.9558H170.125L165.253 22.3798L170.917 28.8598H167.077L162.253 22.8838V28.8598H159.181Z"
            fill="#1E3050"
          />
          <path
            d="M177.621 29.1478C176.421 29.1478 175.357 28.8918 174.429 28.3798C173.501 27.8678 172.773 27.1478 172.245 26.2198C171.717 25.2918 171.453 24.2198 171.453 23.0038C171.453 21.7718 171.709 20.6758 172.221 19.7158C172.749 18.7558 173.469 18.0118 174.381 17.4838C175.309 16.9398 176.397 16.6678 177.645 16.6678C178.813 16.6678 179.845 16.9238 180.741 17.4358C181.637 17.9478 182.333 18.6518 182.829 19.5478C183.341 20.4278 183.597 21.4118 183.597 22.4998C183.597 22.6758 183.589 22.8598 183.573 23.0518C183.573 23.2438 183.565 23.4438 183.549 23.6518H174.501C174.565 24.5798 174.885 25.3078 175.461 25.8358C176.053 26.3638 176.765 26.6278 177.597 26.6278C178.221 26.6278 178.741 26.4918 179.157 26.2198C179.589 25.9318 179.909 25.5638 180.117 25.1158H183.237C183.013 25.8678 182.637 26.5558 182.109 27.1798C181.597 27.7878 180.957 28.2678 180.189 28.6198C179.437 28.9718 178.581 29.1478 177.621 29.1478ZM177.645 19.1638C176.893 19.1638 176.229 19.3798 175.653 19.8118C175.077 20.2278 174.709 20.8678 174.549 21.7318H180.477C180.429 20.9478 180.141 20.3238 179.613 19.8598C179.085 19.3958 178.429 19.1638 177.645 19.1638Z"
            fill="#1E3050"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M20.1668 37.4231C23.5654 37.4231 26.3206 34.6679 26.3206 31.2692L26.3206 29.7308L14.0129 29.7308L14.0129 31.2692C14.0129 34.6679 16.7681 37.4231 20.1668 37.4231ZM10.936 29.7308L10.936 31.2692C10.936 36.3672 15.0687 40.5 20.1667 40.5C25.2648 40.5 29.3975 36.3672 29.3975 31.2692L29.3975 29.7308L30.936 29.7308C36.034 29.7308 40.1667 25.598 40.1667 20.5C40.1668 15.402 36.034 11.2692 30.936 11.2692L29.3975 11.2692L29.3975 9.73077C29.3975 4.63275 25.2648 0.500003 20.1668 0.500002C15.0687 0.500002 10.936 4.63276 10.936 9.73077L10.936 11.2692L9.39752 11.2692C4.29951 11.2692 0.166754 15.402 0.166754 20.5C0.166753 25.598 4.29951 29.7308 9.39752 29.7308L10.936 29.7308ZM14.0129 26.6538L26.3206 26.6538L26.3206 14.3462L14.0129 14.3462L14.0129 26.6538ZM10.936 14.3462L10.936 26.6538L9.39752 26.6538C5.99885 26.6538 3.24367 23.8987 3.24367 20.5C3.24367 17.1013 5.99885 14.3462 9.39752 14.3462L10.936 14.3462ZM14.0129 11.2692L26.3206 11.2692L26.3206 9.73077C26.3206 6.33209 23.5654 3.57693 20.1668 3.57693C16.7681 3.57693 14.0129 6.33209 14.0129 9.73077L14.0129 11.2692ZM29.3975 14.3462L29.3975 26.6538L30.936 26.6538C34.3347 26.6538 37.0898 23.8987 37.0898 20.5C37.0898 17.1013 34.3347 14.3462 30.936 14.3462L29.3975 14.3462Z"
            fill="#7238FA"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M12.4745 11.2693C13.3242 11.2693 14.013 11.9581 14.013 12.8077C14.013 13.6574 13.3242 14.3462 12.4745 14.3462C11.6248 14.3462 10.936 13.6574 10.936 12.8077C10.936 11.9581 11.6248 11.2693 12.4745 11.2693ZM12.4745 26.6539C13.3242 26.6539 14.013 27.3427 14.013 28.1924C14.013 29.042 13.3242 29.7308 12.4745 29.7308C11.6248 29.7308 10.936 29.042 10.936 28.1924C10.936 27.3427 11.6248 26.6539 12.4745 26.6539ZM29.3975 12.8077C29.3975 11.9581 28.7087 11.2693 27.859 11.2693C27.0093 11.2693 26.3206 11.9581 26.3206 12.8077C26.3206 13.6574 27.0093 14.3462 27.859 14.3462C28.7087 14.3462 29.3975 13.6574 29.3975 12.8077ZM27.859 26.6539C28.7087 26.6539 29.3975 27.3427 29.3975 28.1924C29.3975 29.042 28.7087 29.7308 27.859 29.7308C27.0093 29.7308 26.3206 29.042 26.3206 28.1924C26.3206 27.3427 27.0093 26.6539 27.859 26.6539Z"
            fill="white"
          />
        </g>
        <defs>
          <clipPath id="clip0_7299_71079">
            <rect
              width="183.667"
              height="40"
              fill="white"
              transform="translate(0.166748 0.5)"
            />
          </clipPath>
        </defs>
      </svg>

      <div className="login">
        <div className="container">
          <Formik
            initialValues={{
              email: "",
              password: "",
            }}
            validationSchema={Yup.object({
              email: Yup.string()
                .email("Invalid email address")
                .required("Email address is require"),
              password: Yup.string().required("Password is require"),
            })}
            onSubmit={async (values) => {
              setShakeAnim(false);
              const res = await setLogin(
                values.email,
                values.password,
                "admin"
              );
              if (res && "token" in res) {
                if (res?.user?.role === "admin") navigate("/admin/icons");
                else {
                  setShakeAnim(true);
                  notifyError("You are not allowed to access admin");
                }
              } else {
                setShakeAnim(true);
              }
            }}
          >
            {({ values, isValid, handleSubmit }) => {
              const isDisabled =
                values.email && values.password ? !isValid : true;

              return (
                <Form>
                  <div className="signin-input-body">
                    <div>
                      <LabledInputBox
                        name="email"
                        type={"email"}
                        placeholder="Email"
                        lable={"Email"}
                        values={values.email}
                      />
                    </div>
                    <div>
                      <LabledInputBox
                        name="password"
                        type={"password"}
                        placeholder="password"
                        lable={"password"}
                        values={values.password}
                      />
                    </div>
                    <div className="email-sign-in-form"></div>
                    <div className={isDisabled ? "disabled button" : "button"} onClick={handleSubmit}>
                      <svg
                        className="icon-sign-in"
                        width="20"
                        height="21"
                        viewBox="0 0 20 21"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M11.3478 17.5L18.5 10.5M18.5 10.5L11.3478 3.5M18.5 10.5L-8.34743e-08 10.5"
                          stroke="#1E3050"
                          strokeWidth="2"
                        />
                      </svg>

                      <div className="button2">Login </div>
                    </div>
                  </div>
                </Form>
              );
            }}
          </Formik>
        </div>
      </div>
      <div className="copyright">
        <div className="powered-by-sketchish-2018-2023-all-rights-reserved-v-1-0">
          Powered by Sketchish ©2018-2023. All rights reserved. | V1.0{" "}
        </div>
      </div>
    </div>
  );
}
